<!DOCTYPE html>
<html lang="id" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Post Test Result Detail - Bidan</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap"
      rel="stylesheet"
    />
    <script src="/_sdk/element_sdk.js"></script>
    <link rel="stylesheet" href="css/detail_post_test.css" />
    <style>
      body {
        box-sizing: border-box;
      }
    </style>
    <script
      src="https://cdn.tailwindcss.com/3.4.17"
      type="text/javascript"
    ></script>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="main-container">
      <!-- Breadcrumb -->
      <div class="breadcrumb-section">
        <span>Dashboard Bidan</span> <span>/</span>
        <span>Hasil Post Test</span> <span>/</span> <span>Detail</span>
      </div>
      <!-- Header -->
      <div class="header-section">
        <button class="btn-back" id="backBtn" onclick="handleBack()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewbox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 19l-7-7 7-7"
            />
          </svg>
        </button>
        <div>
          <h1 id="pageTitle">Detail Hasil Post Test Pasien</h1>
        </div>
      </div>
      <!-- Patient Info Card -->
      <div class="card-section">
        <div class="patient-header-main">
          <div class="patient-avatar">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewbox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
          </div>
          <div class="patient-name-section">
            <h2 id="patientName">Siti Nur Azizah</h2>
            <p>Perempuan • 32 tahun</p>
          </div>
        </div>
        <div class="patient-info-grid">
          <div class="info-item">
            <span class="info-label" id="mrnLabel">Nomor Rekam Medis</span>
            <span class="info-value">RM-2024-00156</span>
          </div>
          <div class="info-item">
            <span class="info-label" id="testDateLabel">Tanggal Pengisian</span>
            <span class="info-value">15 Desember 2024</span>
          </div>
          <div class="info-item">
            <span class="info-label">Waktu Pengisian</span>
            <span class="info-value">14:30 WIB</span>
          </div>
          <div class="info-item">
            <span class="info-label">Status Hasil</span>
            <div style="margin-top: 0.25rem">
              <span class="status-badge good" id="statusBadge">
                <div class="status-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewbox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 12l2 2 4-4m7 0a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                </div>
                <span>Baik</span>
              </span>
            </div>
          </div>
        </div>
      </div>
      <!-- Summary Card -->
      <div class="card-section">
        <div class="summary-section">
          <div class="summary-title" id="summaryTitle">Ringkasan Hasil</div>
          <div class="score-display" id="scoreDisplay">4</div>
          <div class="score-max">dari 10 pertanyaan</div>
          <div class="progress-wrapper">
            <div class="progress-label">
              <span class="progress-label-text">Tingkat Pemahaman</span>
              <span class="progress-percentage" id="scorePercentage">80%</span>
            </div>
            <div class="progress">
              <div
                class="progress-bar-custom"
                id="progressBar"
                style="width: 80%"
              ></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Questions Section -->
      <div class="questions-container" id="questionsContainer"></div>
      <!-- Action Buttons -->
      <div class="action-section">
        <button
          class="btn-action secondary"
          id="backButton"
          onclick="handleBack()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewbox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 19l-7-7 7-7"
            /></svg
          ><span id="backButtonText">Kembali ke Dashboard</span>
        </button>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Default configuration
      const defaultConfig = {
        page_title: 'Detail Hasil Post Test Pasien',
        back_button_text: 'Kembali ke Dashboard',
        patient_name: 'Siti Nur Azizah',
        mrn_label: 'Nomor Rekam Medis',
        test_date_label: 'Tanggal Pengisian',
        summary_title: 'Ringkasan Hasil',
      };

      // Post Test Questions Data
      const questions = [
        {
          id: 1,
          text: 'Tujuan skrining kesehatan jiwa pada calon pengantin adalah untuk…',
          options: [
            'Mengetahui jenis kelamin calon bayi',
            'Mendeteksi dini gangguan mental emosional',
            'Menentukan jumlah anak',
          ],
          correct: 1,
          answer: 1,
        },
        {
          id: 2,
          text: 'Usia ideal untuk hamil adalah…',
          options: ['< 20 tahun', '20–34 tahun', '> 35 tahun'],
          correct: 1,
          answer: 1,
        },
        {
          id: 3,
          text: 'Jarak kehamilan yang dianjurkan adalah…',
          options: ['1 tahun', '2 tahun', '3 bulan'],
          correct: 1,
          answer: 1,
        },
        {
          id: 4,
          text: 'Berikut yang termasuk dalam 4 Terlalu (4T) adalah…',
          options: [
            'Terlalu sehat',
            'Terlalu dekat jarak kehamilan (< 2 tahun)',
            'Terlalu bahagia',
          ],
          correct: 1,
          answer: 1,
        },
        {
          id: 5,
          text: 'Ibu hamil usia > 35 tahun termasuk kategori…',
          options: ['Terlalu muda', 'Terlalu tua', 'Terlalu banyak'],
          correct: 1,
          answer: 1,
        },
        {
          id: 6,
          text: 'Metode KB jangka panjang adalah…',
          options: ['Kondom', 'Pil KB', 'Implant'],
          correct: 2,
          answer: 2,
        },
        {
          id: 7,
          text: 'Program KB bertujuan untuk…',
          options: [
            'Mempercepat kehamilan',
            'Menunda dan mengatur jarak kehamilan',
            'Menghentikan kehamilan permanen',
          ],
          correct: 1,
          answer: 1,
        },
        {
          id: 8,
          text: 'Deteksi penyakit menular meliputi…',
          options: [
            'HIV, Sifilis, Hepatitis B',
            'TBC dan Asma',
            'Hipertensi dan Stroke',
          ],
          correct: 0,
          answer: 0,
        },
        {
          id: 9,
          text: 'Metode KB jangka pendek adalah…',
          options: ['IUD', 'Implant', 'Pil KB'],
          correct: 2,
          answer: 2,
        },
        {
          id: 10,
          text: 'KB yang dipasang di dalam rahim disebut…',
          options: ['IUD / Spiral', 'Pil KB', 'Kondom'],
          correct: 0,
          answer: 0,
        },
      ];

      // Calculate score
      function calculateScore() {
        return questions.filter((q) => q.answer === q.correct).length;
      }

      // Get option class name
      function getOptionClass(index) {
        const classes = ['option-a', 'option-b', 'option-c'];
        return classes[index] || 'option-a';
      }

      // Render questions
      function renderQuestions() {
        const container = document.getElementById('questionsContainer');
        container.innerHTML = '';

        questions.forEach((question, idx) => {
          const questionCard = document.createElement('div');
          questionCard.className = 'question-card';
          questionCard.innerHTML = `
          <div class="question-number">Pertanyaan ${question.id} dari ${
            questions.length
          }</div>
          <div class="question-text">${question.text}</div>
          <div class="options-grid">
            ${question.options
              .map(
                (option, optionIdx) => `
              <div class="option-button
  ${getOptionClass(optionIdx)}
  ${optionIdx === question.answer ? 'selected' : ''}
  ${optionIdx === question.correct ? 'correct-answer' : ''}
  ${
    optionIdx === question.answer && question.answer !== question.correct
      ? 'wrong-answer'
      : ''
  }">

  <div class="option-check">
    ${optionIdx === question.correct ? '✓' : ''}
    ${
      optionIdx === question.answer && question.answer !== question.correct
        ? '✕'
        : ''
    }
  </div>

  <div>${option}</div>

  <div class="option-label">
    ${String.fromCharCode(65 + optionIdx)}
  </div>

  ${
    optionIdx === question.answer
      ? '<div class="answer-label">Jawaban Pasien</div>'
      : ''
  }

  ${
    optionIdx === question.correct
      ? '<div class="answer-label">Jawaban Benar</div>'
      : ''
  }

</div>
            `
              )
              .join('')}
          </div>
        `;
          container.appendChild(questionCard);
        });
      }

      // Update score display
      function updateScoreDisplay() {
        const score = calculateScore();
        const percentage = Math.round((score / questions.length) * 100);

        document.getElementById('scoreDisplay').textContent = score;
        document.getElementById('scorePercentage').textContent =
          percentage + '%';
        document.getElementById('progressBar').style.width = percentage + '%';

        // Update status badge based on score
        const statusBadge = document.getElementById('statusBadge');
        if (percentage >= 80) {
          statusBadge.className = 'status-badge good';
          statusBadge.innerHTML = `
          <div class="status-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m7 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          </div><span>Baik</span>
        `;
        } else if (percentage >= 60) {
          statusBadge.className = 'status-badge fair';
          statusBadge.innerHTML = `
          <div class="status-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          </div><span>Cukup</span>
        `;
        } else {
          statusBadge.className = 'status-badge consult';
          statusBadge.innerHTML = `
          <div class="status-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4v2m0 0v2m0-6h2m-4 0h2" /></svg>
          </div><span>Perlu Konsultasi</span>
        `;
        }
      }

      // Initialize Element SDK
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            document.getElementById('pageTitle').textContent =
              config.page_title || defaultConfig.page_title;
            document.getElementById('backButtonText').textContent =
              config.back_button_text || defaultConfig.back_button_text;
            document.getElementById('patientName').textContent =
              config.patient_name || defaultConfig.patient_name;
            document.getElementById('mrnLabel').textContent =
              config.mrn_label || defaultConfig.mrn_label;
            document.getElementById('testDateLabel').textContent =
              config.test_date_label || defaultConfig.test_date_label;
            document.getElementById('summaryTitle').textContent =
              config.summary_title || defaultConfig.summary_title;
          },
          mapToCapabilities: (config) => ({
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined,
          }),
          mapToEditPanelValues: (config) =>
            new Map([
              ['page_title', config.page_title || defaultConfig.page_title],
              [
                'back_button_text',
                config.back_button_text || defaultConfig.back_button_text,
              ],
              [
                'patient_name',
                config.patient_name || defaultConfig.patient_name,
              ],
              ['mrn_label', config.mrn_label || defaultConfig.mrn_label],
              [
                'test_date_label',
                config.test_date_label || defaultConfig.test_date_label,
              ],
              [
                'summary_title',
                config.summary_title || defaultConfig.summary_title,
              ],
            ]),
        });
      }

      // Initialize page
      function initializePage() {
        renderQuestions();
        updateScoreDisplay();
      }

      // Handle back button
      function handleBack() {
        const btnText = document.getElementById('backButtonText').textContent;
        window.location.href = 'dashboard_bidan.html'
      }

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', initializePage);
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement('script');
            d.innerHTML =
              "window.__CF$cv$params={r:'9d23a181755cccfd',t:'MTc3MTgxNzI4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName('head')[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement('iframe');
          a.height = 1;
          a.width = 1;
          a.style.position = 'absolute';
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = 'none';
          a.style.visibility = 'hidden';
          document.body.appendChild(a);
          if ('loading' !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener('DOMContentLoaded', c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              'loading' !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
