<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SRQ - Self Reporting Questionnaire</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="stylesheet" href="css/test_srq.css">
  <style>body { box-sizing: border-box; }</style>
  <script src="https://cdn.tailwindcss.com/3.4.17" type="text/javascript"></script>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body>
  <div class="main-container">
   <div class="container" style="max-width: 720px;"><!-- Header -->
    <div class="header-section">
     <div class="header-icon">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg>
     </div>
     <h1 class="page-title" id="pageTitle">Self Reporting Questionnaire</h1>
     <p class="page-subtitle" id="pageSubtitle">Jawab pertanyaan berikut sesuai kondisi yang Anda rasakan dalam 30 hari terakhir</p>
    </div><!-- Info Badge -->
    <div class="text-center">
     <div class="info-badge">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg><span>Pilih Ya atau Tidak untuk setiap pertanyaan</span>
     </div>
    </div><!-- Progress -->
    <div class="progress-indicator"><span class="progress-text"><span id="answeredCount">0</span>/29 terjawab
     <div class="progress-bar-custom">
      <div class="progress-fill" id="progressFill"></div>
     </div>
    </div><!-- Validation Message -->
    <div class="validation-message" id="validationMessage">
     Mohon jawab semua pertanyaan sebelum mengirim
    </div><!-- Questions Form -->
    <form id="srqForm">
        <div class="question-card">

            <!-- LOOP 1â€“29 -->
            <script>
            const questions = [
            "Apakah Anda sering menderita sakit kepala?",
            "Apakah Anda kehilangan nafsu makan?",
            "Apakah tidur Anda tidak lelap?",
            "Apakah Anda mudah menjadi takut?",
            "Apakah Anda merasa cemas, tegang dan khawatir?",
            "Apakah tangan Anda gemetar?",
            "Apakah Anda mengalami gangguan pencernaan?",
            "Apakah Anda merasa sulit berpikir jernih?",
            "Apakah Anda merasa tidak bahagia?",
            "Apakah Anda lebih sering menangis?",
            "Apakah Anda merasa sulit untuk menikmati aktivitas sehari-hari?",
            "Apakah Anda mengalami kesulitan untuk mengambil keputusan?",
            "Apakah aktivitas/tugas sehari-hari Anda terbengkalai?",
            "Apakah Anda merasa tidak mampu berperan dalam kehidupan ini?",
            "Apakah Anda kehilangan minat terhadap banyak hal?",
            "Apakah Anda merasa tidak berharga?",
            "Apakah Anda mempunyai pikiran untuk mengakhiri hidup Anda?",
            "Apakah Anda merasa lelah sepanjang waktu?",
            "Apakah Anda merasa tidak enak di perut?",
            "Apakah Anda mudah lelah?",
            "Apakah Anda minum alkohol lebih banyak dari biasanya atau menggunakan narkoba?",
            "Apakah Anda yakin bahwa seseorang mencoba mencelakai Anda?",
            "Apakah ada yang mengganggu atau hal tidak biasa dalam pikiran Anda?",
            "Apakah Anda pernah mendengar suara tanpa tahu sumbernya?",
            "Apakah Anda mengalami mimpi yang mengganggu tentang bencana?",
            "Apakah Anda menghindari hal yang mengingatkan pada bencana tersebut?",
            "Apakah minat Anda terhadap teman dan kegiatan berkurang?",
            "Apakah Anda merasa sangat terganggu jika mengingat bencana?",
            "Apakah Anda kesulitan memahami atau mengekspresikan perasaan?"
            ];
            
            const container = document.currentScript.parentElement;
            
            questions.forEach((q, i) => {
              const num = i + 1;
            
              container.insertAdjacentHTML('beforeend', `
                <div class="question-item" data-question="${num}">
                  <div class="d-flex align-items-start">
                    <span class="question-number">${num}</span>
                    <div class="flex-grow-1">
                      <p class="question-text mb-0">${q}</p>
                    </div>
                  </div>
            
                  <div class="options-wrapper">
                    <div class="form-check option-yes">
                      <input class="form-check-input" type="radio" name="q${num}" id="q${num}yes" value="1">
                      <label class="form-check-label" for="q${num}yes">Ya</label>
                    </div>
            
                    <div class="form-check option-no">
                      <input class="form-check-input" type="radio" name="q${num}" id="q${num}no" value="0">
                      <label class="form-check-label" for="q${num}no">Tidak</label>
                    </div>
                  </div>
                </div>
              `);
            });
            </script>
            
            </div>
     </div><!-- Submit Button -->
     <div class="submit-section"><a href="dashboard_pasien.html" class="btn btn-submit" id="submitBtn"> <span id="submitBtnText">Kirim Jawaban</span>
       <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2" class="ms-2" style="display: inline-block; vertical-align: middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
       </svg></a>
     </div>
    </form>
   </div>
  </div><!-- Result Overlay -->
  <div class="result-overlay" id="resultOverlay">
   <div class="result-card">
    <div class="result-icon" id="resultIcon">
     <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
     </svg>
    </div>
    <h2 class="result-title">Hasil Skrining Anda</h2>
    <div class="result-score"><span id="scoreValue">0</span>/29
    </div>
    <p class="result-description" id="resultDescription">Deskripsi hasil akan muncul di sini.</p><button class="btn-close-result" id="closeResult">Tutup &amp; Mulai Ulang</button>
   </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
        // Default configuration
        const defaultConfig = {
            page_title: 'Self Reporting Questionnaire',
            subtitle: 'Jawab pertanyaan berikut sesuai kondisi yang Anda rasakan dalam 30 hari terakhir',
            submit_button_text: 'Kirim Jawaban',
            background_color: '#FDF6EC',
            surface_color: '#FFFFFF',
            text_color: '#2D3748',
            primary_action_color: '#CFE8E5',
            secondary_action_color: '#E6E6FA'
        };

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange: async (config) => {
                    // Update page title
                    document.getElementById('pageTitle').textContent = config.page_title || defaultConfig.page_title;
                    
                    // Update subtitle
                    document.getElementById('pageSubtitle').textContent = config.subtitle || defaultConfig.subtitle;
                    
                    // Update submit button text
                    document.getElementById('submitBtnText').textContent = config.submit_button_text || defaultConfig.submit_button_text;

                    // Apply colors
                    const bgColor = config.background_color || defaultConfig.background_color;
                    const surfaceColor = config.surface_color || defaultConfig.surface_color;
                    const textColor = config.text_color || defaultConfig.text_color;
                    const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
                    const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

                    document.body.style.background = `linear-gradient(135deg, ${bgColor} 0%, #D6E6F2 50%, ${secondaryColor} 100%)`;
                    
                    document.querySelectorAll('.question-card').forEach(card => {
                        card.style.background = `rgba(255, 255, 255, 0.95)`;
                    });

                    document.querySelectorAll('.question-item').forEach(item => {
                        item.style.background = bgColor;
                    });

                    document.querySelectorAll('.page-title, .result-title').forEach(el => {
                        el.style.color = textColor;
                    });

                    document.querySelectorAll('.btn-submit').forEach(btn => {
                        btn.style.background = `linear-gradient(135deg, ${primaryColor}, #B8D8D4)`;
                    });

                    document.querySelectorAll('.option-yes .form-check-label').forEach(label => {
                        label.style.borderColor = primaryColor;
                    });

                    document.querySelectorAll('.option-no .form-check-label').forEach(label => {
                        label.style.borderColor = secondaryColor;
                    });
                },
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        },
                        {
                            get: () => config.surface_color || defaultConfig.surface_color,
                            set: (value) => {
                                config.surface_color = value;
                                window.elementSdk.setConfig({ surface_color: value });
                            }
                        },
                        {
                            get: () => config.text_color || defaultConfig.text_color,
                            set: (value) => {
                                config.text_color = value;
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        },
                        {
                            get: () => config.primary_action_color || defaultConfig.primary_action_color,
                            set: (value) => {
                                config.primary_action_color = value;
                                window.elementSdk.setConfig({ primary_action_color: value });
                            }
                        },
                        {
                            get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                            set: (value) => {
                                config.secondary_action_color = value;
                                window.elementSdk.setConfig({ secondary_action_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ['page_title', config.page_title || defaultConfig.page_title],
                    ['subtitle', config.subtitle || defaultConfig.subtitle],
                    ['submit_button_text', config.submit_button_text || defaultConfig.submit_button_text]
                ])
            });
        }

        // Form handling
        const form = document.getElementById('srqForm');
        const resultOverlay = document.getElementById('resultOverlay');
        const closeResult = document.getElementById('closeResult');
        const validationMessage = document.getElementById('validationMessage');
        const progressFill = document.getElementById('progressFill');
        const answeredCount = document.getElementById('answeredCount');

        // Update progress as user answers
        form.addEventListener('change', updateProgress);

        function updateProgress() {
            let answered = 0;
            for (let i = 1; i <= 29; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) answered++;
            }
            answeredCount.textContent = answered;
            progressFill.style.width = `${(answered / 29) * 100}%`;
        }

        // Form submission
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            let totalScore = 0;
            let allAnswered = true;

            for (let i = 1; i <= 29; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) {
                    totalScore += parseInt(selected.value);
                } else {
                    allAnswered = false;
                }
            }

            if (!allAnswered) {
                validationMessage.classList.add('show');
                setTimeout(() => {
                    validationMessage.classList.remove('show');
                }, 3000);
                return;
            }

            // Show result
            document.getElementById('scoreValue').textContent = totalScore;
            
            const resultIcon = document.getElementById('resultIcon');
            const resultDescription = document.getElementById('resultDescription');
            
            if (totalScore <= 3) {
                resultIcon.className = 'result-icon low';
                resultDescription.textContent = 'Hasil skrining menunjukkan kondisi kesehatan mental Anda dalam kategori baik. Tetap jaga pola hidup sehat dan kelola stres dengan baik. Jika ada keluhan, jangan ragu untuk berkonsultasi.';
            } else if (totalScore <= 6) {
                resultIcon.className = 'result-icon medium';
                resultDescription.textContent = 'Hasil skrining menunjukkan ada beberapa gejala yang perlu diperhatikan. Pertimbangkan untuk berkonsultasi dengan tenaga kesehatan profesional untuk evaluasi lebih lanjut.';
            } else {
                resultIcon.className = 'result-icon high';
                resultDescription.textContent = 'Hasil skrining menunjukkan Anda mungkin mengalami tekanan yang cukup berat. Sangat disarankan untuk segera berkonsultasi dengan psikolog atau psikiater untuk mendapatkan penanganan yang tepat.';
            }

            resultOverlay.classList.add('show');
        });

        // Close result and reset
        closeResult.addEventListener('click', function() {
            resultOverlay.classList.remove('show');
            form.reset();
            updateProgress();
        });

        // Close on overlay click
        resultOverlay.addEventListener('click', function(e) {
            if (e.target === resultOverlay) {
                resultOverlay.classList.remove('show');
                form.reset();
                updateProgress();
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d0aa80eb561e780',t:'MTc3MTU1NTQwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>