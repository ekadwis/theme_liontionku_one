<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SRQ Result - Patient</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/hasil_srq.css">
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com/3.4.17" type="text/javascript"></script>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <style>body { box-sizing: border-box; }</style>
 </head>
 <body>
  <div class="main-container">
   <div class="content-wrapper"><!-- Header with Back Button -->
    <div class="header-bar"><button class="btn-back" id="backBtn" onclick="handleBack()">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg></button>
     <div class="header-title">
      <h1 id="pageTitle">Hasil Skrining SRQ</h1>
     </div>
    </div><!-- Patient Info Card -->
    <div class="patient-card"><!-- Patient Header -->
     <div class="patient-header">
      <div class="patient-avatar">
       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
       </svg>
      </div>
      <div class="patient-info">
       <h2 id="patientName">Budi Santoso</h2>
       <p>ID Pasien: PST-2024-001</p>
      </div>
     </div><!-- Score Section -->
     <div class="score-section">
      <div class="score-label">
       Total Skor SRQ
      </div>
      <h3 class="score-number" id="scoreNumber">26</h3>
      <div class="score-max" id="scoreMax"></div>
      <div class="progress-wrapper">
       <div class="progress-label"><span class="progress-label-text">Tingkat Gejala</span> <span class="progress-percentage" id="scorePercentage">90%</span>
       </div>
       <div class="progress">
        <div class="progress-bar-custom" id="progressBar" style="width: 90%;"></div>
       </div>
      </div>
     </div><!-- Status Badge -->
     <div class="status-wrapper">
      <div class="status-badge warning" id="statusBadge">
       <div class="status-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
       </div><span id="statusLabel">Perlu Konsultasi</span>
      </div>
     </div><!-- Interpretation -->
     <div class="interpretation-card">
      <div class="interpretation-title">
       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
       </svg> Interpretasi Hasil
      </div>
      <p class="interpretation-text" id="interpretationText">Hasil skrining menunjukkan Anda mengalami gejala gangguan kesehatan mental yang cukup signifikan. Beberapa gejala seperti kecemasan, kesulitan tidur, dan perasaan tertekan terlihat menonjol. Sangat disarankan untuk melakukan konsultasi dengan profesional kesehatan mental untuk evaluasi lebih lanjut dan mendapatkan penanganan yang sesuai.</p>
     </div><!-- Recommendations -->
     <div class="recommendation-card">
      <div class="recommendation-title">
       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
       </svg><span id="consultationNote">Rekomendasi Selanjutnya</span>
      </div>
      <ul class="recommendation-list">
       <li class="recommendation-item">
        <div class="recommendation-dot"></div><span>Lakukan konsultasi dengan psikolog atau psikiater dalam waktu dekat</span></li>
       <li class="recommendation-item">
        <div class="recommendation-dot"></div><span>Terapkan teknik manajemen stres seperti meditasi atau mindfulness</span></li>
       <li class="recommendation-item">
        <div class="recommendation-dot"></div><span>Jaga pola tidur yang teratur dan lakukan aktivitas fisik ringan</span></li>
       <li class="recommendation-item">
        <div class="recommendation-dot"></div><span>Komunikasikan perasaan Anda kepada keluarga atau orang terpercaya</span></li>
      </ul>
     </div><!-- Statistics Grid -->
     <div class="chart-grid">
      <div class="chart-item">
       <div class="chart-item-label">
        Gejala Fisik
       </div>
       <div class="chart-item-value">
        40%
       </div>
      </div>
      <div class="chart-item">
       <div class="chart-item-label">
        Emosional
       </div>
       <div class="chart-item-value">
        70%
       </div>
      </div>
      <div class="chart-item">
       <div class="chart-item-label">
        Fungsi Sosial
       </div>
       <div class="chart-item-value">
        50%
       </div>
      </div>
     </div><!-- Action Buttons -->
     <div class="action-section"><button class="btn-action secondary" id="backButton" onclick="handleBack()">
       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
       </svg><span id="backButtonText">Kembali ke Dashboard</span> </button>
     </div>
    </div>
   </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Default configuration
    const defaultConfig = {
      page_title: 'Hasil Skrining SRQ',
      back_button_text: 'Kembali ke Dashboard',
      patient_name: 'Budi Santoso',
      status_label: 'Perlu Konsultasi',
      consultation_note: 'Rekomendasi Selanjutnya',
      background_color: '#FDF6EC',
      surface_color: '#FFFFFF',
      text_color: '#2D3748',
      primary_action_color: '#CFE8E5',
      secondary_action_color: '#E6E6FA'
    };

    // Dummy patient data with different scenarios
    const patientData = {
      id: 'PST-2024-001',
      name: 'Budi Santoso',
      score: 20,
      status: 'warning', // 'normal', 'warning', 'urgent'
      physicalSymptoms: 40,
      emotionalSymptoms: 70,
      socialFunction: 50
    };

    // Calculate percentage
    function calculatePercentage(score, max = 29) {
      return Math.round((score / max) * 100);
    }

    // Get status info based on score
    function getStatusInfo(score) {
      if (score <= 3) {
        return {
          status: 'normal',
          label: 'Status: Baik',
          class: 'normal',
          interpretation: 'Hasil skrining menunjukkan kondisi kesehatan mental Anda dalam kategori baik. Tidak ada tanda-tanda gangguan kesehatan mental yang signifikan. Terus jaga pola hidup sehat dan kelola stres dengan baik.'
        };
      } else if (score <= 6) {
        return {
          status: 'warning',
          label: 'Perlu Konsultasi',
          class: 'warning',
          interpretation: 'Hasil skrining menunjukkan Anda mengalami gejala gangguan kesehatan mental yang cukup signifikan. Beberapa gejala seperti kecemasan, kesulitan tidur, dan perasaan tertekan terlihat menonjol. Sangat disarankan untuk melakukan konsultasi dengan profesional kesehatan mental.'
        };
      } else {
        return {
          status: 'urgent',
          label: 'Perlu Perhatian Urgent',
          class: 'urgent',
          interpretation: 'Hasil skrining menunjukkan Anda mengalami gejala gangguan kesehatan mental yang sangat serius. Diperlukan penanganan profesional segera. Silakan hubungi layanan kesehatan mental atau rumah sakit untuk mendapatkan evaluasi dan penanganan yang tepat.'
        };
      }
    }

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          // Update page title
          document.getElementById('pageTitle').textContent = config.page_title || defaultConfig.page_title;

          // Update patient name
          document.getElementById('patientName').textContent = config.patient_name || defaultConfig.patient_name;

          // Update back button text
          document.getElementById('backButtonText').textContent = config.back_button_text || defaultConfig.back_button_text;

          // Update status label
          document.getElementById('statusLabel').textContent = config.status_label || defaultConfig.status_label;

          // Update consultation note
          document.getElementById('consultationNote').textContent = config.consultation_note || defaultConfig.consultation_note;

          // Apply colors
          const bgColor = config.background_color || defaultConfig.background_color;
          const surfaceColor = config.surface_color || defaultConfig.surface_color;
          const textColor = config.text_color || defaultConfig.text_color;
          const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
          const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

          document.body.style.background = `linear-gradient(135deg, ${bgColor} 0%, #D6E6F2 50%, ${secondaryColor} 100%)`;

          document.querySelectorAll('.patient-card, .chart-item').forEach(el => {
            el.style.background = surfaceColor ? `rgba(255, 255, 255, 0.95)` : '';
          });

          document.querySelectorAll('.page-title, .interpretation-title').forEach(el => {
            el.style.color = textColor;
          });

          document.querySelectorAll('.btn-action.primary').forEach(btn => {
            btn.style.background = `linear-gradient(135deg, ${primaryColor}, #B8D8D4)`;
          });
        },
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.surface_color || defaultConfig.surface_color,
              set: (value) => {
                config.surface_color = value;
                window.elementSdk.setConfig({ surface_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.primary_action_color || defaultConfig.primary_action_color,
              set: (value) => {
                config.primary_action_color = value;
                window.elementSdk.setConfig({ primary_action_color: value });
              }
            },
            {
              get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
              set: (value) => {
                config.secondary_action_color = value;
                window.elementSdk.setConfig({ secondary_action_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['page_title', config.page_title || defaultConfig.page_title],
          ['back_button_text', config.back_button_text || defaultConfig.back_button_text],
          ['patient_name', config.patient_name || defaultConfig.patient_name],
          ['status_label', config.status_label || defaultConfig.status_label],
          ['consultation_note', config.consultation_note || defaultConfig.consultation_note]
        ])
      });
    }

    // Initialize page with data
    function initializePage() {
      const statusInfo = getStatusInfo(patientData.score);
      const percentage = calculatePercentage(patientData.score);

      // Update score display
      document.getElementById('scoreMax').textContent = 'dari 29 poin';
      document.getElementById('scoreNumber').textContent = patientData.score;
      document.getElementById('scorePercentage').textContent = percentage + '%';
      document.getElementById('progressBar').style.width = percentage + '%';

      // Update status
      const statusBadge = document.getElementById('statusBadge');
      statusBadge.className = `status-badge ${statusInfo.class}`;
      document.getElementById('statusLabel').textContent = statusInfo.label;

      // Update interpretation
      document.getElementById('interpretationText').textContent = statusInfo.interpretation;

      // Update statistics
      document.querySelectorAll('.chart-item')[0].querySelector('.chart-item-value').textContent = patientData.physicalSymptoms + '%';
      document.querySelectorAll('.chart-item')[1].querySelector('.chart-item-value').textContent = patientData.emotionalSymptoms + '%';
      document.querySelectorAll('.chart-item')[2].querySelector('.chart-item-value').textContent = patientData.socialFunction + '%';
    }

    // Handle back button
    function handleBack() {
      alert('Kembali ke Halaman Test SRQ');
        setTimeout(() => {
          window.location.href = 'hasil_srq_test.html';
        }, 500);
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', initializePage);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9d0ac2fbb5c9afeb',t:'MTc3MTU1NjUxMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>